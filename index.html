<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ê¸°ë…êµì¥ë¡œíšŒ í•´ì™¸ ì„ êµë™ì—­ì ì§€ë„</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body { margin: 0; font-family: sans-serif; }
        h1 { text-align: center; padding: 10px; }
        #map { height: 100vh; width: 100vw; }

        /* êµ­ê¸° ì•„ì´ì½˜ */
        .flag-icon { width: 20px; height: 15px; vertical-align: middle; margin-right: 5px; }
        
        /* ë§ˆì»¤ íŒì—… ë¦¬ìŠ¤íŠ¸ */
        .popup-list { margin-top: 4px; padding: 2px 0; }
        .popup-list:hover { cursor: pointer; color: blue; text-decoration: underline; }

        /* íƒ€ì´í‹€ */
        .top-title {
        position: absolute;
        top: 18px;
        left: 0; right: 0;
        text-align: center;
        color: white;
        font-size: 2rem;
        text-shadow: 0 2px 8px rgba(0,0,0,0.6);
        z-index: 1050;
        pointer-events: none;
        margin: 0;
        padding: 0;
        font-family: inherit;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 14px;
        }
        .title-logo {
        height: 40px;     /* ì›í•˜ëŠ” íƒ€ì´í‹€ ë†’ì´ì— ë§ê²Œ ê³ ì •! */
        width: auto;
        vertical-align: middle;
        pointer-events: none;
        /* ë°°ê²½ì´ íˆ¬ëª…í•˜ë©´ ì´ë ‡ê²Œ, í•„ìš” ì—†ìœ¼ë©´ ì‚­ì œ */
        border-radius: 8px;
        padding: 4px 8px;
        box-sizing: content-box;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        /* í•„ìš”ì‹œ ì•„ë˜ì²˜ëŸ¼ í¬ê¸° ì¡°ì •:
        margin-right: 12px;
        */
        }
        @media (max-width: 600px) {
        .top-title { font-size: 1.1rem; gap:7px;}
        .title-logo { height: 26px; padding:1px 3px;}
        }




        
        /* ìƒì„¸ ì •ë³´ íŒì—… */
        .detail-popup {
            position: absolute; /* functions.jsì—ì„œ ë™ì ìœ¼ë¡œ ìœ„ì¹˜ ì„¤ì • */
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            z-index: 1000; /* ë‹¤ë¥¸ ìš”ì†Œë³´ë‹¤ ìœ„ì— ì˜¤ë„ë¡ ì„¤ì • */
            display: none;
            width: 300px;
        }
        .detail-popup h3 { margin-top: 0; }
        .detail-popup img { width: 100%; border-radius: 8px; margin-bottom: 10px; }
        .detail-popup .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            color: #333;
            font-weight: bold;
            font-size: 16px;
        }

        /* í”Œë¡œíŒ… ë©”ì‹œì§€ (ì• ë‹ˆë©”ì´ì…˜ í¬í•¨) */
        .floating-missionary-wrapper {
            position: absolute;
            z-index: 999;
            pointer-events: none; /* í´ë¦­ ì´ë²¤íŠ¸ ë°©í•´í•˜ì§€ ì•Šë„ë¡ ì„¤ì • */
        }
        .floating-missionary-content {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            border: 2px solid #ccc;
        }
        .floating-missionary-content.recent {
            border-color: orange;
        }
        .floating-missionary-content img {
            width: 24px;
            height: 24px;
            border-radius: 50%;
        }
        .floating-missionary-content .name {
            font-weight: bold;
            color: #333;
        }
        .floating-missionary-content.recent .name {
            color: orange;
        }
        .floating-missionary-content .prayer {
            font-size: 13px;
            color: #555;
        }

        @keyframes floatUpFade {
            0% { transform: translateY(10px) scale(0.95); opacity: 0; }
            50% { transform: translateY(-5px) scale(1); opacity: 1; }
            100% { transform: translateY(-20px) scale(1.02); opacity: 0; }
        }
    </style>
</head>
<body>

    <div id="map"></div>
    <div id="detailPopup" class="detail-popup"></div>
    <h1 class="top-title"><img src="logo.svg" alt=" " class="title-logo">í•œêµ­ê¸°ë…êµì¥ë¡œíšŒ í•´ì™¸ ì„ êµë™ì—­ì ì§€ë„</h1>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // --- STEP 1: ë°ì´í„° í†µí•© ë° ì„¤ì • ---

        // `missionary_data.json` ì˜ ë°ì´í„°ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©
        const missionaryDetails = [
  { "name": "ê°€ì •ìˆœ", "english_name": "Rev. Ka Jung-Soon", "city": "í–ê¾¸ë‹Œì¬¬", "organization": "ì¼ë³¸ê¸°ë…êµë‹¨ ì†Œì† í–ê¾¸ë‹Œì¬¬êµíšŒ", "presbytery": "ì„œìš¸ë…¸íšŒ", "sent_date": "1996-05-01", "country": "ì¼ë³¸" },
    { "name": "ê¹€ì¢…í˜„", "english_name": "Rev. Kim Jong-Hyun", "city": "ì˜¤ì‚¬ì¹´", "organization": "ì¬ì¼ëŒ€í•œê¸°ë…êµíšŒ ì†Œì† ì˜¤ì‚¬ì¹´ ë‚˜ë‹ˆì™€êµíšŒ", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "1996-12-01", "country": "ì¼ë³¸" },
    { "name": "ì‹ ìš©ì„­", "english_name": "Rev. Shin Yong-Sub", "city": "ì˜¤ì‚¬ì¹´", "organization": "ì¬ì¼ëŒ€í•œê¸°ë…êµíšŒ ì˜¤ì‚¬ì¹´êµêµ¬ ë‚˜ë‹ˆì™€êµíšŒ ë° KCCJ íšŒê´€", "presbytery": "ì„œìš¸ë‚¨ë…¸íšŒ", "sent_date": "2012-02-01", "country": "ì¼ë³¸" },
    { "name": "ì •ì§€ì˜", "english_name": "Rev. Jeong Jee-Young", "city": "ê°€ë‚˜ê°€ì™€", "organization": "ì¼ë³¸ê¸°ë…êµë‹¨ ê°€ë‚˜ê°€ì™€êµêµ¬ ê³ í† ë¶€í‚¤ì§€êµ¬ ì„¼í„°", "presbytery": "ê²½ë¶ë…¸íšŒ", "sent_date": "2012-04-01", "country": "ì¼ë³¸" },
    { "name": "ê¹€ì„±ì–¸", "english_name": "Rev. Kim Sung-Un", "city": "ì‹œëª¨ë…¸ì„¸í‚¤", "organization": "ì¬ì¼ëŒ€í•œê¸°ë…êµíšŒ ì‹œëª¨ë…¸ì„¸í‚¤ êµíšŒ", "presbytery": "ì„œìš¸ë‚¨ë…¸íšŒ", "sent_date": "2018-05-01", "country": "ì¼ë³¸" },

    // í•„ë¦¬í•€ ì˜ˆì‹œ
    { "name": "ê¹€í˜„ìˆ™", "english_name": "Rev. Kim Hyun-Sook", "city": "ë¯¼ë‹¤ë‚˜ì˜¤", "organization": "í•„ë¦¬í•€ ë¯¼ë‹¤ë‚˜ì˜¤ ì„ êµì„¼í„°", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2001-06-15", "country": "í•„ë¦¬í•€" },
    { "name": "ê¸ˆì„ì¸", "english_name": "Rev. Keum Seok-In", "city": "ë§ˆë‹ë¼", "organization": "ì•„ì¹´í˜êµíšŒ", "presbytery": "ì„œìš¸ë¶ë…¸íšŒ", "sent_date": "2007-09-20", "country": "í•„ë¦¬í•€" },
    { "name": "ê°•ê²½ì§„", "english_name": "Rev. Kang Kyung-Jin", "city": "ë£¨ì†", "organization": "UCCP ê·¸ë¦¬ìŠ¤ë„ì—°í•©êµíšŒ", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2010-01-10", "country": "í•„ë¦¬í•€" },
    { "name": "ë°©íƒœí™”", "english_name": "Rev. Bang Tae-Hwa", "city": "ì„¸ë¶€", "organization": "ì„œë¶€ ì„œë¹„ì‹œì•¼ ì„¸ë¶€ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë…¸íšŒ", "sent_date": "2014-03-15", "country": "í•„ë¦¬í•€" },
    { "name": "ê¹€ì˜ê¶Œ", "english_name": "Rev. Kim Young-Kwon", "city": "ì¤‘ë¶€ë£¨ì†", "organization": "ì¤‘ë¶€ë£¨ì† ì„ êµì„¼í„°", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2018-07-05", "country": "í•„ë¦¬í•€" },
    { "name": "ì •ê´‘í™”", "english_name": "Rev. Jeong Kwang-Hwa", "city": "ë£¨ì†", "organization": "ë£¨ì†ì„¬ ì„ êµíšŒ", "presbytery": "ì„œìš¸ë‚¨ë…¸íšŒ", "sent_date": "2020-12-21", "country": "í•„ë¦¬í•€" },
    
      // ëŒ€ë§Œ ì˜ˆì‹œ
    { "name": "ê¹€ê¸°íƒœ", "english_name": "Rev. Kim Ki-Tae", "city": "íŒŒì´ì™„", "organization": "íŒŒì´ì™„ë…¸íšŒ", "presbytery": "ì„œìš¸ë™ë…¸íšŒ", "sent_date": "2002-04-15", "country": "ëŒ€ë§Œ" },
    { "name": "ì´ê°•ì„", "english_name": "Rev. Lee Kang-Seok", "city": "ì‹ ë² ì´", "organization": "ìœ ì‚°ì‹ í•™êµ", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2006-10-02", "country": "ëŒ€ë§Œ" },
    { "name": "ì¡°í•˜ì˜", "english_name": "Rev. Jo Ha-Young", "city": "ì¹ ì„±", "organization": "ì¹ ì„±ì¤‘íšŒ", "presbytery": "ì„œìš¸ì„œë…¸íšŒ", "sent_date": "2011-02-08", "country": "ëŒ€ë§Œ" },
    { "name": "ë°•ê·¼ì˜", "english_name": "Rev. Park Geun-Young", "city": "ì¹ ì„±", "organization": "ì¹ ì„±ì¤‘íšŒ", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2015-09-19", "country": "ëŒ€ë§Œ" },

    // ëŸ¬ì‹œì•„ ì˜ˆì‹œ
    { "name": "ì´ìƒì ", "english_name": "Rev. Lee Sang-Jeom", "city": "ë¸”ë¼ë””ë³´ìŠ¤í† í¬", "organization": "ì—°í•´ì£¼ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë‚¨ë…¸íšŒ", "sent_date": "2013-06-01", "country": "ëŸ¬ì‹œì•„" },

    // ëª½ê³¨ ì˜ˆì‹œ
    { "name": "ê¹€ìƒí—Œ", "english_name": "Rev. Kim Sang-Heon", "city": "ìš¸ë€ë°”í† ë¥´", "organization": "êµ­ì œëŒ€í•™", "presbytery": "ì„œìš¸ë™ë…¸íšŒ", "sent_date": "2005-11-11", "country": "ëª½ê³¨" },

    // íŒŒí‚¤ìŠ¤íƒ„ ì˜ˆì‹œ
    { "name": "ê¹€ì‹ ë¯¸", "english_name": "Rev. Kim Shin-Mi", "city": "ì´ìŠ¬ë¼ë§ˆë°”ë“œ", "organization": "ì´ìŠ¬ë¼ë§ˆë°”ë“œ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë…¸íšŒ", "sent_date": "2009-08-20", "country": "íŒŒí‚¤ìŠ¤íƒ„" },

    // ë¼ì˜¤ìŠ¤
    { "name": "ì°¨ëª…ë ¬", "english_name": "Rev. Cha Myung-Ryeol", "city": "ë¹„ì—”í‹°ì•ˆ", "organization": "ë”˜ë”” ìœ ì¹˜ì›", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2010-05-20", "country": "ë¼ì˜¤ìŠ¤" },
    { "name": "ì •ë³‘ê¶Œ", "english_name": "Rev. Jeong Byung-Kwon", "city": "ë¹„ì—”í‹°ì•ˆ", "organization": "ë¼ì˜¤ìŠ¤ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë™ë…¸íšŒ", "sent_date": "2014-11-02", "country": "ë¼ì˜¤ìŠ¤" },

    // ì¸ë„
    { "name": "ê¹€ê¸ˆì• ", "english_name": "Rev. Kim Geum-Ae", "city": "ë¸ë¦¬", "organization": "ë¶ì¸ë„ ì„ êµì„¼í„°", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2003-03-03", "country": "ì¸ë„" },
    { "name": "ì´ì˜¥í¬", "english_name": "Rev. Lee Ok-Hee", "city": "ì²¸ë‚˜ì´", "organization": "ë‚¨ì¸ë„ ì„ êµì„¼í„°", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2012-09-14", "country": "ì¸ë„" },
    { "name": "ì •í˜¸ì§„", "english_name": "Rev. Jung Ho-Jin", "city": "ë²µê°ˆë£¨ë£¨", "organization": "ìƒëª…ëˆ„ë¦¬ì„¼í„°", "presbytery": "ì„œìš¸ì„œë…¸íšŒ", "sent_date": "2017-02-28", "country": "ì¸ë„" },
    { "name": "ê¹€ê²½ë¯¸", "english_name": "Rev. Kim Kyung-Mi", "city": "ëƒ”ë‹¬", "organization": "ë‚¨ì¸ë„ ëƒ”ë‹¬ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë‚¨ë…¸íšŒ", "sent_date": "2016-10-17", "country": "ì¸ë„" },
    { "name": "ì´í™”ë‘", "english_name": "Rev. Lee Hwa-Rang", "city": "ë§ˆë“œë¼ìŠ¤", "organization": "ë§ˆë“œë¼ìŠ¤ ì„ êµì„¼í„°", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2014-06-23", "country": "ì¸ë„" },
    { "name": "ì´ë„í˜•", "english_name": "Rev. Lee Do-Hyung", "city": "ì²¸ë‚˜ì´", "organization": "ì²¸ë‚˜ì´ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë¶ë…¸íšŒ", "sent_date": "2019-12-09", "country": "ì¸ë„" },

    // ì¸ë„ë„¤ì‹œì•„
    { "name": "ê¹€ê´‘í›ˆ", "english_name": "Rev. Kim Kwang-Hoon", "city": "íŒŒìˆœë‹¨", "organization": "íŒŒìˆœë‹¨êµíšŒ", "presbytery": "ì„œìš¸ë™ë…¸íšŒ", "sent_date": "2008-05-08", "country": "ì¸ë„ë„¤ì‹œì•„" },
    { "name": "ì„¤ë‚˜ë¼(ê³ ê¹€ì˜ê´‘)", "english_name": "Rev. Seol Na-Ra", "city": "íŒŒìˆœë‹¨", "organization": "íŒŒìˆœë‹¨êµíšŒ", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2011-03-19", "country": "ì¸ë„ë„¤ì‹œì•„" },
    { "name": "ë°•ì¤€í˜¸", "english_name": "Rev. Park Joon-Ho", "city": "ìì¹´ë¥´íƒ€", "organization": "ë™ë¶€ìì™€êµíšŒ", "presbytery": "ì„œìš¸ì„œë…¸íšŒ", "sent_date": "2015-08-25", "country": "ì¸ë„ë„¤ì‹œì•„" },

    // ë™í‹°ëª¨ë¥´
    { "name": "ê¹€ì˜¥ê²¸", "english_name": "Rev. Kim Ok-Gyeom", "city": "ë”œë¦¬", "organization": "IPTL", "presbytery": "ì„œìš¸ë…¸íšŒ", "sent_date": "2014-11-14", "country": "ë™í‹°ëª¨ë¥´" },

    // ë„¤íŒ”
    { "name": "ìœ¤ì¢…ìˆ˜", "english_name": "Rev. Yoon Jong-Soo", "city": "ì¹´íŠ¸ë§Œë‘", "organization": "NCC, Concern Nepal", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2007-04-16", "country": "ë„¤íŒ”" },
    { "name": "ìµœì–‘ì„", "english_name": "Rev. Choi Yang-Im", "city": "ì¹´íŠ¸ë§Œë‘", "organization": "ë„¤íŒ” ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë¶ë…¸íšŒ", "sent_date": "2010-01-19", "country": "ë„¤íŒ”" },
    { "name": "í—ˆ í˜„", "english_name": "Rev. Heo Hyun", "city": "í‹°ë²³", "organization": "í‹°ë²³ ë¶ˆêµê¶Œ ì„ êµ", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2012-05-25", "country": "ë„¤íŒ”" },
    { "name": "ì´ìˆ˜ì—´", "english_name": "Rev. Lee Soo-Yeol", "city": "ì¹´íŠ¸ë§Œë‘", "organization": "ì¹´íŠ¸ë§Œë‘ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë™ë…¸íšŒ", "sent_date": "2016-07-03", "country": "ë„¤íŒ”" },
    { "name": "ê¹€ì„ íƒœ", "english_name": "Rev. Kim Sun-Tae", "city": "ì¹´íŠ¸ë§Œë‘", "organization": "ì¹´íŠ¸ë§Œë‘ ì„ êµì„¼í„°", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2018-09-30", "country": "ë„¤íŒ”" },
    { "name": "ê¹€ì¢…ì°¬", "english_name": "Rev. Kim Jong-Chan", "city": "ì¹´íŠ¸ë§Œë‘", "organization": "ì¹´íŠ¸ë§Œë‘ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë‚¨ë…¸íšŒ", "sent_date": "2021-03-16", "country": "ë„¤íŒ”" },

    // ë§ë ˆì´ì‹œì•„
    { "name": "ê¹€ì¬ì„ ", "english_name": "Rev. Kim Jae-Sun", "city": "ë³´ë£¨ë„¤ì˜¤", "organization": "ë³´ë£¨ë„¤ì˜¤ ì„ êµì„¼í„°", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2015-10-10", "country": "ë§ë ˆì´ì‹œì•„" },

    // ì•„í”„ë¦¬ì¹´ ì£¼ìš”êµ­ê°€ ì˜ˆì‹œ
    { "name": "ìµœì„±ìš±", "english_name": "Rev. Choi Sung-Wook", "city": "ë‚˜ì´ë¡œë¹„", "organization": "ë™ì•„í”„ë¦¬ì¹´ ê°œí˜êµíšŒ", "presbytery": "ì„œìš¸ì„œë…¸íšŒ", "sent_date": "2009-02-12", "country": "ì¼€ëƒ" },
    { "name": "ìœ¤ì˜êµ­", "english_name": "Rev. Yoon Young-Kuk", "city": "ì™€ê°€ë‘êµ¬", "organization": "ë¶€ë¥´í‚¤ë‚˜íŒŒì†Œ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë‚¨ë…¸íšŒ", "sent_date": "2013-03-28", "country": "ë¶€ë¥´í‚¤ë‚˜íŒŒì†Œ" },
    { "name": "ì‹¬ì¬ì›", "english_name": "Rev. Shim Jae-Won", "city": "ëˆ„ì•…ì‡¼íŠ¸", "organization": "ë¶ì•„í”„ë¦¬ì¹´ YWAM", "presbytery": "ì„œìš¸ë™ë…¸íšŒ", "sent_date": "2018-08-04", "country": "ëª¨ë¦¬íƒ€ë‹ˆ" },
    { "name": "ì´ê¸°ì¤€", "english_name": "Rev. Lee Ki-Jun", "city": "ëª¬ë¡œë¹„ì•„", "organization": "ë¼ì´ë² ë¦¬ì•„ ì„ êµì„¼í„°", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2016-06-11", "country": "ë¼ì´ë² ë¦¬ì•„" },
    { "name": "ê¹€ì£¼í˜„", "english_name": "Rev. Kim Joo-Hyun", "city": "ë¦´ë¡±ê¶¤", "organization": "ë¦´ë¡±ê¶¤ ì„ êµì„¼í„°", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2017-10-05", "country": "ë§ë¼ìœ„" },
    { "name": "ì´ìœ¤ì¬", "english_name": "Rev. Lee Yoon-Jae", "city": "ì¿ ë¯¸", "organization": "ì¿ ë¯¸ëŒ€í•™/UCUëŒ€í•™", "presbytery": "ì„œìš¸ë™ë…¸íšŒ", "sent_date": "2015-12-18", "country": "ìš°ê°„ë‹¤" },

    // ë¯¸êµ­/ìœ ëŸ½
    { "name": "ì¥í˜¸ì¤€", "english_name": "Rev. Jang Ho-Joon", "city": "ìŠ¤í† ì–´ìŠ¤", "organization": "ìŠ¤í† ì–´ìŠ¤ í•œì¸êµíšŒ", "presbytery": "ì„œìš¸ë‚¨ë…¸íšŒ", "sent_date": "2003-09-27", "country": "ë¯¸êµ­" },
    { "name": "ì„ìˆœì‹¬", "english_name": "Rev. Lim Soon-Shim", "city": "ì•„ë°”ë‚˜", "organization": "ì‹ í•™êµ ì‚¬ì—­", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2012-05-17", "country": "ì¿ ë°”" },

    // ìœ ëŸ½ ì˜ˆì‹œ
    { "name": "ì¡°ì„±í˜¸", "english_name": "Rev. Jo Sung-Ho", "city": "ë² ë¥¼ë¦°", "organization": "ë² ë¥¼ë¦°ê¸°ë…êµí•œì¸êµíšŒ", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2007-08-15", "country": "ë…ì¼" },
    { "name": "ê¹€ê¸°ì²œ", "english_name": "Rev. Kim Ki-Chun", "city": "ë² ë¥¼ë¦°", "organization": "ë² ë¥¼ë¦°ì£¼êµíšŒ", "presbytery": "ì„œìš¸ì„œë…¸íšŒ", "sent_date": "2010-12-12", "country": "ë…ì¼" },
    { "name": "ê°•ë¯¼ì˜", "english_name": "Rev. Kang Min-Young", "city": "í”„ë‘í¬í‘¸ë¥´íŠ¸", "organization": "ë¼ì¸ë§ˆì¸ í•œì¸êµíšŒ", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2019-01-23", "country": "ë…ì¼" },
    { "name": "ê¹€ì„ êµ¬", "english_name": "Rev. Kim Sun-Koo", "city": "ë¶€ë‹¤í˜ìŠ¤íŠ¸", "organization": "ë¶€ë‹¤í˜ìŠ¤íŠ¸í•œì¸êµíšŒ", "presbytery": "ì„œìš¸ë™ë…¸íšŒ", "sent_date": "2014-03-12", "country": "í—ê°€ë¦¬" },
    { "name": "ê¹€ë‹¤ì†œ", "english_name": "Rev. Kim Da-Som", "city": "ë¶€ë‹¤í˜ìŠ¤íŠ¸", "organization": "ë¶€ë‹¤í˜ìŠ¤íŠ¸í•œì¸êµíšŒ", "presbytery": "ì„œìš¸ë¶ë…¸íšŒ", "sent_date": "2018-05-20", "country": "í—ê°€ë¦¬" },
    { "name": "ìµœì¢…ê´€", "english_name": "Rev. Choi Jong-Gwan", "city": "ë¶€ë‹¤í˜ìŠ¤íŠ¸", "organization": "ë¶€ë‹¤í˜ìŠ¤íŠ¸í•œì¸êµíšŒ", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2020-10-10", "country": "í—ê°€ë¦¬" },

    // ì¤‘ë™/ì´ìŠ¤ë¼ì—˜
    { "name": "ê¹€ì •í™˜", "english_name": "Rev. Kim Jung-Hwan", "city": "ë‚˜ì‚¬ë ›", "organization": "ì•„ëì´ìŠ¤ë¼ì—˜êµíšŒ", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2011-04-07", "country": "ì´ìŠ¤ë¼ì—˜" },
    { "name": "ì•ˆìƒê·¼", "english_name": "Rev. Ahn Sang-Keun", "city": "ê°ˆë¦´ë¦¬", "organization": "ê°ˆë¦´ë¦¬ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë™ë…¸íšŒ", "sent_date": "2016-06-25", "country": "ì´ìŠ¤ë¼ì—˜" },

    // ë¶ˆê°€ë¦¬ì•„
    { "name": "ê¹€ì˜ì¤‘", "english_name": "Rev. Kim Young-Joong", "city": "ì†Œí”¼ì•„", "organization": "ë¶ˆê°€ë¦¬ì•„ ì„ êµì„¼í„°", "presbytery": "ì„œìš¸ë…¸íšŒ", "sent_date": "2015-03-11", "country": "ë¶ˆê°€ë¦¬ì•„" },

    // ë‰´ì§ˆëœë“œ
    { "name": "ë¥˜ ìˆ™", "english_name": "Rev. Ryu Sook", "city": "ì˜¤í´ëœë“œ", "organization": "ì˜¤í´ëœë“œ í•œì¸êµíšŒ", "presbytery": "ê²½ê¸°ë‚¨ë…¸íšŒ", "sent_date": "2012-12-02", "country": "ë‰´ì§ˆëœë“œ" },

    // í˜¸ì£¼
    { "name": "ìµœë²”ìš±", "english_name": "Rev. Choi Bum-Wook", "city": "ì‹œë“œë‹ˆ", "organization": "ì‹œë“œë‹ˆ ìƒˆë‚ êµíšŒ", "presbytery": "ì„œìš¸ë¶ë…¸íšŒ", "sent_date": "2017-04-16", "country": "í˜¸ì£¼" },
    { "name": "ì´ë³‘ê´€", "english_name": "Rev. Lee Byung-Kwan", "city": "ì¼€ì–¸ì¦ˆ", "organization": "ì¼€ì–¸ì¦ˆ ì œìë“¤êµíšŒ", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2019-08-09", "country": "í˜¸ì£¼" },

    // ë‚¨ë¯¸Â·ì•„í”„ë¦¬ì¹´(ì˜ˆì‹œ)
    { "name": "ê¹€ì£¼í˜„", "english_name": "Rev. Kim Joo-Hyun", "city": "ë¦´ë¡±ê¶¤", "organization": "ë¦´ë¡±ê¶¤ ì„ êµì„¼í„°", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2017-10-05", "country": "ë§ë¼ìœ„" },
    { "name": "ì„ìˆœì‹¬", "english_name": "Rev. Lim Soon-Shim", "city": "ì•„ë°”ë‚˜", "organization": "ì¿ ë°” ì‹ í•™êµ ì‚¬ì—­", "presbytery": "ê²½ê¸°ë¶ë…¸íšŒ", "sent_date": "2012-05-17", "country": "ì¿ ë°”" },

    // ê¸°íƒ€ ì˜ˆì‹œ(ì•„ë˜ì— í•„ìš”ì‹œ ê³„ì† ì¶”ê°€ ê°€ëŠ¥)
    // { "name": "ì´ë¦„", "english_name": "ì˜ë¬¸ì´ë¦„", "city": "ë„ì‹œ", "organization": "ê¸°ê´€/êµíšŒ", "presbytery": "ë…¸íšŒ", "sent_date": "YYYY-MM-DD", "country": "êµ­ê°€" },

    
        ];

        // `missionaries.js` ì˜ ê¸°ë„ì œëª©/ì—…ë°ì´íŠ¸ ì •ë³´ë¥¼ ì¶”ê°€ ë°ì´í„°ë¡œ ì‚¬ìš©
        const missionaryExtraInfo = {
            "ê°•ê²½ì§„": { prayer: "ì‹ í•™êµ ì§€ì›", lastUpdate: "2024-08-10" }, "ê°•ë¯¼ì˜": { prayer: "ë…ì¼ êµíšŒ ì—°ê²°", lastUpdate: "2025-02-15" }, "ê¸ˆì„ì¸": { prayer: "ì„ êµì„¼í„° ë¦¬ëª¨ë¸ë§", lastUpdate: "2024-01-14" },
            "ê¹€ê²½ë¯¸": { prayer: "ì¸ë„ ì„ êµ í™•ì¥", lastUpdate: "2025-04-25" }, "ê¹€ê´€ì‹": { prayer: "ìº„ë³´ë””ì•„ ì„±ê²½ ë²ˆì—­", lastUpdate: "2024-10-19" }, "ê¹€ê¸°ì„±": { prayer: "ê°€ì¡± ì •ì°©ê³¼ í•™êµ", lastUpdate: "2024-06-11" },
            "ê¹€ê¸°íƒœ": { prayer: "ì§€ì—­ êµíšŒ í˜‘ë ¥", lastUpdate: "2024-09-05" }, "ê¹€ê¸ˆì• ": { prayer: "ì¸ë„ ë³µìŒ ì „íŒŒ", lastUpdate: "2025-01-12" }, "ê¹€ê¸°ì²œ": { prayer: "ë…ì¼ ì²­ë…„ ì‚¬ì—­", lastUpdate: "2024-05-07" },
            "ê¹€ë‹¤ì†œ": { prayer: "í—ê°€ë¦¬ êµíšŒ ì—°í•©", lastUpdate: "2025-03-01" }, "ê¹€ìƒí—Œ": { prayer: "ëª½ê³¨ì–´ ìŠµë“ê³¼ ë¬¸í™” ì´í•´", lastUpdate: "2024-02-17" }, "ê¹€ì„±ì–¸": { prayer: "ê°€ì • í‰ì•ˆê³¼ ìë…€ êµìœ¡", lastUpdate: "2024-04-13" },
            "ê¹€ì˜ê¶Œ": { prayer: "ê±´ê°•ê³¼ ì–¸ì–´", lastUpdate: "2024-12-09" }, "ê¹€ì˜¥ê²¸": { prayer: "ë™í‹°ëª¨ë¥´ ë³µìŒí™”", lastUpdate: "2024-01-20" }, "ê¹€ì¬ì„ ": { prayer: "ë§ë ˆì´ì‹œì•„ ì„ êµ í™•ì¥", lastUpdate: "2025-05-01" },
            "ê¹€ì •í™˜": { prayer: "ì´ìŠ¤ë¼ì—˜ ì‚¬ì—­ í™•ì¥", lastUpdate: "2024-08-03" }, "ê¹€ì¢…ì°¬": { prayer: "í•™êµ ì„¤ë¦½ ì¤€ë¹„", lastUpdate: "2025-06-01" }, "ê¹€ì¢…í˜„": { prayer: "í˜„ì§€ ì²­ì†Œë…„ ì‚¬ì—­", lastUpdate: "2024-07-18" },
            "ê¹€í˜•ê¸°": { prayer: "ë§ˆì„ ë³µìŒí™”", lastUpdate: "2024-01-01" }, "ê¹€í˜„ìˆ™": { prayer: "ì•„ë™ êµìœ¡ í”„ë¡œê·¸ë¨", lastUpdate: "2024-06-22" }, "ëª…ìŠ¹ì¸": { prayer: "ì²­ì†Œë…„ ìº í”„ ì¤€ë¹„", lastUpdate: "2024-04-04" },
            "ë°•ê·¼ì˜": { prayer: "ê°€ì¡± ê±´ê°•", lastUpdate: "2024-05-05" }, "ë°•ì¤€ìˆ˜": { prayer: "ì‚¬ì—­ í™•ì¥ê³¼ í›„ì›", lastUpdate: "2025-06-03" }, "ë°•ì¤€í˜¸": { prayer: "ì¸ë„ë„¤ì‹œì•„ ë³µìŒí™”", lastUpdate: "2024-10-10" },
            "ë°©íƒœí™”": { prayer: "ì§€ì—­ ë¦¬ë”ì‹­ í›ˆë ¨", lastUpdate: "2025-04-10" }, "ì„¤ë‚˜ë¼(ê³  ê¹€ì˜ê´‘)": { prayer: "ë¬¸í™” ì‚¬ì—­ ì•ˆì •í™”", lastUpdate: "2024-02-05" }, "ì‹ ìš©ì„­": { prayer: "ì˜ë£Œ ì‚¬ì—­ì˜ ì§€í˜œ", lastUpdate: "2024-03-05" },
            "ì‹¬ì¬ì›": { prayer: "ëª¨ë¦¬íƒ€ë‹ˆ êµíšŒ ê°œì²™", lastUpdate: "2025-03-18" }, "ì–‘OO": { prayer: "ë¹„ê³µê°œ ì‚¬ì—­ì˜ ì•ˆì „", lastUpdate: "2024-01-01" }, "ìœ¤ì¢…ìˆ˜": { prayer: "êµíšŒ ë¦¬ë” í›ˆë ¨", lastUpdate: "2024-07-28" },
            "ìœ¤ì˜êµ­": { prayer: "ì„œì•„í”„ë¦¬ì¹´ ë³µìŒí™”", lastUpdate: "2024-11-11" }, "ì´ê°•ì„": { prayer: "í˜„ì§€ í•™êµì™€ ì—°ê²°", lastUpdate: "2024-04-29" }, "ì´ë„í˜•": { prayer: "ë¬¸í™” êµë¥˜ ì‚¬ì—­", lastUpdate: "2025-02-20" },
            "ì´ë³‘ê´€": { prayer: "í˜¸ì£¼ í•œì¸ ì‚¬ì—­", lastUpdate: "2024-10-01" }, "ì´ë¯¼ì¼": { prayer: "ë¹„ì¦ˆë‹ˆìŠ¤ ì„ êµ ì •ì°©", lastUpdate: "2025-03-22" }, "ì´ìˆ˜ì—´": { prayer: "ê°€ì¡± ì•ˆì •ê³¼ ì–¸ì–´", lastUpdate: "2024-06-30" },
            "ì´ì˜¥í¬": { prayer: "ì¸ë„ ì—¬ì„± ì‚¬ì—­", lastUpdate: "2024-07-02" }, "ì´ì¬ê´‘": { prayer: "í˜„ì§€ í˜‘ë ¥ ë‹¨ì²´ì™€ ì—°ëŒ€", lastUpdate: "2025-01-30" }, "ì´í™”ë‘": { prayer: "ì²­ì†Œë…„ ë³µìŒí™”", lastUpdate: "2024-09-19" },
            "ì„ìˆœì‹¬": { prayer: "ì¿ ë°” ì„ êµ ì •ì°©", lastUpdate: "2024-04-02" }, "ì¥í˜¸ì¤€": { prayer: "ë¯¸êµ­ ì§€ì—­ ë³µìŒí™”", lastUpdate: "2025-05-15" }, "ì •ë³‘ê¶Œ": { prayer: "ì„ êµì„¼í„° ìš´ì˜", lastUpdate: "2024-11-01" },
            "ì •ì§€ì˜": { prayer: "ë‹¤ë¬¸í™” ê°€ì • ëŒë´„", lastUpdate: "2024-02-11" }, "ì •í˜¸ì§„": { prayer: "ì¸ë„ ë³µìŒ ìš´ë™", lastUpdate: "2025-03-04" }, "ì¡°ì„±í˜¸": { prayer: "ìœ ëŸ½ êµíšŒ ì—°ëŒ€", lastUpdate: "2025-01-05" },
            "ì¡°í•˜ì˜": { prayer: "ìœ í•™ìƒ ëŒë´„ ì‚¬ì—­", lastUpdate: "2024-06-05" }, "ì°¨ëª…ë ¬": { prayer: "í˜„ì§€ êµíšŒì™€ í˜‘ë ¥", lastUpdate: "2024-05-26" }, "ìµœë²”ìš±": { prayer: "ì‹œë“œë‹ˆ êµíšŒ ê°œì²™", lastUpdate: "2024-08-17" },
            "ìµœì„±ìš±": { prayer: "ì¼€ëƒ êµìœ¡ ì„ êµ", lastUpdate: "2024-07-08" }, "ìµœì–‘ì„": { prayer: "ê³ ì‚°ì§€ëŒ€ ë³µìŒí™”", lastUpdate: "2025-06-04" }, "ìµœì¢…ê´€": { prayer: "í—ê°€ë¦¬ ì²­ë…„ ì œìí›ˆë ¨", lastUpdate: "2024-03-12" },
            "í—ˆí˜„": { prayer: "ì˜ë£Œ ìº í”„ ì‚¬ì—­", lastUpdate: "2024-09-29" }
        };

        // ê¸°ì¡´ `missionaryData`ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±
        const missionaryNamesByCountry = { "ì¼ë³¸": ["ê°€ì •ìˆœ", "ê¹€ì¢…í˜„", "ì‹ ìš©ì„­", "ì •ì§€ì˜", "ê¹€ì„±ì–¸"], "ì¤‘êµ­": ["ì–‘â—‹â—‹"], "ëŒ€ë§Œ": ["ê¹€ê¸°íƒœ", "ì´ê°•ì„", "ì¡°í•˜ì˜","ë°•ê·¼ì˜"], "ëª½ê³¨": ["ê¹€ìƒí—Œ"], "ëŸ¬ì‹œì•„": ["ì´ìƒì "], "í•„ë¦¬í•€": ["ê¹€í˜„ìˆ™", "ê¸ˆì„ì¸", "ê°•ê²½ì§„", "ë°©íƒœí™”", "ê¹€ì˜ê¶Œ", "ì •ê´‘í™”"], "íƒœêµ­": ["ê¹€ì™„ì£¼", "ê¹€ê¸°ì„±", "ì´ì¬ê´‘", "ëª…ìŠ¹ì¸", "ë°•ì¤€ìˆ˜"], "ìº„ë³´ë””ì•„": ["ê¹€í˜•ê¸°", "ê¹€ê´€ì‹", "ì¥ì„±ìˆ™", "í™©í¬ëª…", "ê¹€ê²½í¬", "ì´ë¯¼ì¼", "í™©í•˜ì–€", "ì§„ì¬ì€"], "ë¼ì˜¤ìŠ¤": ["ì°¨ëª…ë ¬", "ì •ë³‘ê¶Œ"], "ì¸ë„": ["ê¹€ê¸ˆì• ", "ì´ì˜¥í¬", "ì •í˜¸ì§„", "ê¹€ê²½ë¯¸", "ì´í™”ë‘", "ì´ë„í˜•"], "ì¸ë„ë„¤ì‹œì•„": ["ê¹€ê´‘í›ˆ", "ì„¤ë‚˜ë¼", "ë°•ì¤€í˜¸"], "íŒŒí‚¤ìŠ¤íƒ„": ["ê¹€ì‹ ë¯¸"], "ë™í‹°ëª¨ë¥´": ["ê¹€ì˜¥ê²¸"], "ë„¤íŒ”": ["ìœ¤ì¢…ìˆ˜", "ìµœì–‘ì„", "í—ˆ í˜„", "ì´ìˆ˜ì—´", "ê¹€ì„ íƒœ", "ê¹€ì¢…ì°¬"], "ë§ë ˆì´ì‹œì•„": ["ê¹€ì¬ì„ "], "ë‰´ì§ˆëœë“œ": ["ë¥˜ ìˆ™"], "í˜¸ì£¼": ["ìµœë²”ìš±", "ì´ë³‘ê´€"], "ì´ìŠ¤ë¼ì—˜": ["ê¹€ì •í™˜", "ì•ˆìƒê·¼"], "ë…ì¼": ["ì¡°ì„±í˜¸", "ê¹€ê¸°ì²œ", "ê°•ë¯¼ì˜"], "í—ê°€ë¦¬": ["ê¹€ì„ êµ¬", "ê¹€ë‹¤ì†œ", "ìµœì¢…ê´€"], "ë¶ˆê°€ë¦¬ì•„": ["ê¹€ì˜ì¤‘"], "ë¶€ë¥´í‚¤ë‚˜íŒŒì†Œ": ["ìœ¤ì˜êµ­"], "ì¼€ëƒ": ["ìµœì„±ìš±"], "ëª¨ë¦¬íƒ€ë‹ˆ": ["ì‹¬ì¬ì›"], "ë¼ì´ë² ë¦¬ì•„": ["ì´ê¸°ì¤€"], "ë§ë¼ìœ„": ["ê¹€ì£¼í˜„"], "ìš°ê°„ë‹¤": ["ì´ìœ¤ì¬"], "ë¯¸êµ­": ["ì¥í˜¸ì¤€"], "ì¿ ë°”": ["ì„ìˆœì‹¬"] };
        
        // ëª¨ë“  ì„ êµì‚¬ ì •ë³´ë¥¼ í•˜ë‚˜ì˜ ê°ì²´ë¡œ í†µí•© (key: ì´ë¦„, value: ìƒì„¸ì •ë³´)
        const missionaryInfo = {};
        Object.values(missionaryNamesByCountry).flat().forEach(name => {
            const details = missionaryDetails.find(m => m.name === name) || {};
            const extraInfo = missionaryExtraInfo[name] || {};
            missionaryInfo[name] = {
                ...details, // íŒŒì†¡ì¼, ì†Œì† ë“±
                ...extraInfo, // ê¸°ë„ì œëª©, ì—…ë°ì´íŠ¸ì¼
                prayer: extraInfo.prayer || "í˜„ì§€ ì •ì°©ê³¼ ê±´ê°•", // ê¸°ë³¸ ê¸°ë„ì œëª©
                lastUpdate: extraInfo.lastUpdate || "2023-01-01"
            };
        });

        // êµ­ê°€ë³„ ìœ„ì¹˜ ë° êµ­ê¸° ì •ë³´
        const latlngs = { "ì¼ë³¸": [36.2048, 138.2529], "ì¤‘êµ­": [35.8617, 104.1954], "ëŒ€ë§Œ": [23.6978, 120.9605], "ëª½ê³¨": [46.8625, 103.8467], "ëŸ¬ì‹œì•„": [61.5240, 105.3188], "í•„ë¦¬í•€": [12.8797, 121.7740], "íƒœêµ­": [15.8700, 100.9925], "ìº„ë³´ë””ì•„": [12.5657, 104.9910], "ë¼ì˜¤ìŠ¤": [19.8563, 102.4955], "ì¸ë„": [20.5937, 78.9629], "ì¸ë„ë„¤ì‹œì•„": [-0.7893, 113.9213], "íŒŒí‚¤ìŠ¤íƒ„": [30.3753, 69.3451], "ë™í‹°ëª¨ë¥´": [-8.8742, 125.7275], "ë„¤íŒ”": [28.3949, 84.1240], "ë§ë ˆì´ì‹œì•„": [4.2105, 101.9758], "ë‰´ì§ˆëœë“œ": [-40.9006, 174.8860], "í˜¸ì£¼": [-25.2744, 133.7751], "ì´ìŠ¤ë¼ì—˜": [31.0461, 34.8516], "ë…ì¼": [51.1657, 10.4515], "í—ê°€ë¦¬": [47.1625, 19.5033], "ë¶ˆê°€ë¦¬ì•„": [42.7339, 25.4858], "ë¶€ë¥´í‚¤ë‚˜íŒŒì†Œ": [12.2383, -1.5616], "ì¼€ëƒ": [0.0236, 37.9062], "ëª¨ë¦¬íƒ€ë‹ˆ": [21.0079, -10.9408], "ë¼ì´ë² ë¦¬ì•„": [6.4281, -9.4295], "ë§ë¼ìœ„": [-13.2543, 34.3015], "ìš°ê°„ë‹¤": [1.3733, 32.2903], "ë¯¸êµ­": [37.0902, -95.7129], "ì¿ ë°”": [21.5218, -77.7812] };
        const countryFlags = { "ì¼ë³¸": "jp", "ì¤‘êµ­": "cn", "ëŒ€ë§Œ": "tw", "ëª½ê³¨": "mn", "ëŸ¬ì‹œì•„": "ru", "í•„ë¦¬í•€": "ph", "íƒœêµ­": "th", "ìº„ë³´ë””ì•„": "kh", "ë¼ì˜¤ìŠ¤": "la", "ì¸ë„": "in", "ì¸ë„ë„¤ì‹œì•„": "id", "íŒŒí‚¤ìŠ¤íƒ„": "pk", "ë™í‹°ëª¨ë¥´": "tl", "ë„¤íŒ”": "np", "ë§ë ˆì´ì‹œì•„": "my", "ë‰´ì§ˆëœë“œ": "nz", "í˜¸ì£¼": "au", "ì´ìŠ¤ë¼ì—˜": "il", "ë…ì¼": "de", "í—ê°€ë¦¬": "hu", "ë¶ˆê°€ë¦¬ì•„": "bg", "ë¶€ë¥´í‚¤ë‚˜íŒŒì†Œ": "bf", "ì¼€ëƒ": "ke", "ëª¨ë¦¬íƒ€ë‹ˆ": "mr", "ë¼ì´ë² ë¦¬ì•„": "lr", "ë§ë¼ìœ„": "mw", "ìš°ê°„ë‹¤": "ug", "ë¯¸êµ­": "us", "ì¿ ë°”": "cu" };

        // --- STEP 2: ì§€ë„ ë° ê¸°ëŠ¥ êµ¬í˜„ ---
        
        // ì „ì—­ ë³€ìˆ˜ ë° ì„¤ì •
        const FLOAT_INTERVAL = 2000; // í”Œë¡œíŒ… ë©”ì‹œì§€ ì£¼ê¸° (ms)
        const POPUP_ROTATE_INTERVAL = 3000; // íŒì—… ìˆœí™˜ ì£¼ê¸° (ms)
        let pause = false; // íŒì—… ìˆœí™˜ ì¼ì‹œì •ì§€ ì—¬ë¶€
        let currentIndex = 0; // í˜„ì¬ ìˆœí™˜ ì¸ë±ìŠ¤
        let byAutoRotate = false; // ìë™ ìˆœí™˜ì— ì˜í•œ ë™ì‘ì¸ì§€ íŒë³„í•˜ëŠ” í”Œë˜ê·¸

        // CSS ì• ë‹ˆë©”ì´ì…˜ ë™ì  ì‚½ì…
        const style = document.createElement('style');
        style.textContent = `.floating-missionary-wrapper { animation: floatUpFade ${FLOAT_INTERVAL * 2}ms ease-in-out forwards; }`;
        document.head.appendChild(style);

        // Leaflet ì§€ë„ ìƒì„±
        const map = L.map('map').setView([20, 0], 2);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap'
        }).addTo(map);

        const detailPopupElement = document.getElementById('detailPopup');

        // ìƒì„¸ ë³´ê¸° íŒì—… í‘œì‹œ í•¨ìˆ˜
        function showDetail(name, latlng) {
            const info = missionaryInfo[name] || {};
            const sentDate = info.sent_date ? new Date(info.sent_date) : null;
            const sentYear = sentDate ? sentDate.getFullYear() : 'ì •ë³´ ì—†ìŒ';

            const point = map.latLngToContainerPoint(latlng);
            const mapRect = map.getContainer().getBoundingClientRect();
            
            detailPopupElement.style.display = 'block';
            detailPopupElement.style.left = `${mapRect.left + point.x + 15}px`;
            detailPopupElement.style.top = `${mapRect.top + point.y - detailPopupElement.offsetHeight / 2}px`;
            detailPopupElement.innerHTML = `
                <div class="close-btn" onclick="closeDetail()">âœ–</div>
                <img src="https://via.placeholder.com/300x180.png?text=${name}" alt="${name}">
                <h3 style="margin-top: 10px;">${name}</h3>
                <p><strong>íŒŒì†¡ë…„ë„:</strong> ${sentYear}ë…„</p>
                <p><strong>ì†Œì†:</strong> ${info.organization || 'ì •ë³´ ì—†ìŒ'}</p>
                <p><strong>ê¸°ë„ì œëª©:</strong> ${info.prayer}</p>
            `;
            pause = true; // ìƒì„¸ íŒì—… ì—´ë©´ ìˆœí™˜ ë©ˆì¶¤
        }

        function closeDetail() {
            detailPopupElement.style.display = 'none';
            pause = false; // íŒì—… ë‹«íˆë©´ ìˆœí™˜ ì¬ê°œ
        }

        function isRecent(updateDate) {
            if (!updateDate) return false;
            const days = (new Date() - new Date(updateDate)) / (1000 * 60 * 60 * 24);
            return days < 60;
        }

        // êµ­ê°€ë³„ ë§ˆì»¤ ìƒì„±
        const markers = Object.entries(missionaryNamesByCountry).map(([country, names]) => {
            const latlng = latlngs[country] || [0, 0];
            const [lat, lng] = latlng;
            const flag = countryFlags[country] ? `<img class='flag-icon' src='https://flagcdn.com/w40/${countryFlags[country]}.png'>` : "";
            
            const popupContent = `${flag}<b>${country}</b><br>` +
                names.map(name => {
                    const info = missionaryInfo[name] || {};
                    const recentStyle = isRecent(info.lastUpdate) ? "style='color: orange; font-weight: bold'" : "";
                    return `<div class='popup-list' ${recentStyle} onclick='showDetail("${name}", [${lat}, ${lng}])'>${name}</div>`;
                }).join("");

            const marker = L.marker([lat, lng]).addTo(map);
            marker.bindPopup(popupContent);

            marker.on('popupopen', () => {
                if (!byAutoRotate) pause = true;
                byAutoRotate = false;
            });

            marker.on('popupclose', () => {
                pause = false;
            });
            return marker;
        });

        // ì§€ë„ í´ë¦­ ì‹œ ëª¨ë“  íŒì—… ë‹«ê³  ìˆœí™˜ ì¬ê°œ
        map.on('click', () => {
            markers.forEach(marker => marker.closePopup());
            closeDetail();
        });

        // íŒì—… ìë™ ìˆœí™˜ ê¸°ëŠ¥
        setInterval(() => {
            if (!pause && markers.length > 0) {
                if (map.getContainer().querySelector('.leaflet-popup-content')) {
                    // ìˆ˜ë™ìœ¼ë¡œ ì—´ë¦° íŒì—…ì´ ìˆë‹¤ë©´ ë‹«ê³  ì¸ë±ìŠ¤ ì¬ì„¤ì •
                    markers.forEach(m => m.closePopup());
                }
                byAutoRotate = true;
                markers[currentIndex].openPopup();
                currentIndex = (currentIndex + 1) % markers.length;
            }
        }, POPUP_ROTATE_INTERVAL);
        
        // í”Œë¡œíŒ… ê¸°ë„ì œëª© í‘œì‹œë¥¼ ìœ„í•œ ë°ì´í„° ì¤€ë¹„ (ìµœì‹  ì—…ë°ì´íŠ¸ ìˆœ)
        const flatMissionaries = Object.values(missionaryInfo)
            .filter(info => info.name && info.country)
            .sort((a, b) => new Date(b.lastUpdate) - new Date(a.lastUpdate));
            
        let floatingIndex = 0;

        // í”Œë¡œíŒ… ê¸°ë„ì œëª© í‘œì‹œ í•¨ìˆ˜
        function showFloatingMissionary() {
            if (pause || flatMissionaries.length === 0) return;

            const item = flatMissionaries[floatingIndex];
            const latlng = latlngs[item.country];
            if (!latlng) return;

            const [lat, lng] = latlng;
            const recent = isRecent(item.lastUpdate);

            const point = map.latLngToContainerPoint([lat + (Math.random() - 0.5) * 3, lng + (Math.random() - 0.5) * 3]);
            
            const wrapper = document.createElement("div");
            wrapper.className = "floating-missionary-wrapper";
            wrapper.innerHTML = `
              <div class="floating-missionary-content ${recent ? 'recent' : ''}">
                <img src="https://cdn-icons-png.flaticon.com/128/149/149071.png" alt="icon">
                <div>
                  <div class="name">${item.name}</div>
                  <div class="prayer">${item.prayer}</div>
                </div>
              </div>
            `;
            wrapper.style.left = `${point.x - 50}px`;
            wrapper.style.top = `${point.y - 20}px`;

            map.getContainer().appendChild(wrapper);

            setTimeout(() => wrapper.remove(), FLOAT_INTERVAL * 2);
            
            floatingIndex = (floatingIndex + 1) % flatMissionaries.length;
        }
        
        setInterval(showFloatingMissionary, FLOAT_INTERVAL);

    </script>


<!-- ì „ì²´í™”ë©´ í† ê¸€ ë²„íŠ¼ -->
<div id="fullscreenBtn" class="fullscreen-btn" title="ì „ì²´í™”ë©´ ë³´ê¸°">
  ğŸ–µ
</div>
<!-- ì „ì²´í™”ë©´ í•´ì œ ë²„íŠ¼(ì²˜ìŒì—” ìˆ¨ê¹€) -->
<div id="exitFullscreenBtn" class="fullscreen-btn" style="display:none;" title="ì „ì²´í™”ë©´ ì¢…ë£Œ">
  âœ–
</div>

<style>
.fullscreen-btn {
  position: fixed;
  bottom: 32px;
  right: 32px;
  width: 48px; height: 48px;
  background: rgba(40,40,40,0.6);
  color: white;
  border-radius: 12px;
  display: flex; align-items: center; justify-content: center;
  font-size: 2rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.18);
  cursor: pointer;
  z-index: 1200;
  user-select: none;
  transition: background 0.2s;
}
.fullscreen-btn:hover {
  background: rgba(40,40,40,0.8);
}
@media (max-width: 600px) {
  .fullscreen-btn { right: 12px; bottom: 12px; width:40px; height:40px; font-size:1.5rem;}
}

// ì§€ë„íƒ€ì´í‹€ë””ìì¸
#map {
  height: 100vh;
  width: 100vw;
}

.top-title {
  position: absolute;
  top: 18px;
  left: 0; right: 0;
  text-align: center;
  color: white;
  font-size: 2rem;
  text-shadow: 0 2px 8px rgba(0,0,0,0.6);
  z-index: 1050;
  pointer-events: none; /* í´ë¦­ ë°©í•´ ì•ˆ ë˜ê²Œ */
  margin: 0;
  padding: 0;
  font-family: inherit;
}









</style>
// ì „ì²´í™”ë©´ ì§„ì…
<script>
document.getElementById('fullscreenBtn').onclick = function() {
  document.documentElement.requestFullscreen();
};

// ì „ì²´í™”ë©´ í•´ì œ
document.getElementById('exitFullscreenBtn').onclick = function() {
  if (document.fullscreenElement) {
    document.exitFullscreen();
  }
};

// ì „ì²´í™”ë©´ ìƒíƒœ ê°ì§€ â†’ ë²„íŠ¼ í† ê¸€ (ìœ íŠœë¸Œ ìŠ¤íƒ€ì¼)
document.addEventListener('fullscreenchange', () => {
  const isFull = !!document.fullscreenElement;
  document.getElementById('fullscreenBtn').style.display = isFull ? "none" : "flex";
  document.getElementById('exitFullscreenBtn').style.display = isFull ? "flex" : "none";
  // Leaflet ì§€ë„ë¼ë©´ ì‚¬ì´ì¦ˆ ì¬ì¡°ì •
  if (typeof map !== "undefined" && map.invalidateSize) {
    setTimeout(()=>map.invalidateSize(), 400);
  }
});
</script>               

</body>
</html>
